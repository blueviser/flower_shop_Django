{% extends 'base.html' %}
{% load static %}

{% block title %}Bloom | Премиальные цветы с доставкой{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="hero-bg"></div>
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title">Цветы, которые <span class="text-gradient">говорят</span> за вас</h1>
            <p class="hero-subtitle">Самые свежие букеты от ведущих флористов с доставкой в день заказа</p>
            <div class="hero-actions">
                <a href="{% url 'shop:product_list' %}" class="btn btn-primary">
                    <i class="ri-shopping-bag-line"></i>
                    <span>Смотреть коллекцию</span>
                </a>
                <a href="#collections" class="btn btn-outline">
                    <i class="ri-flower-line"></i>
                    <span>Выбрать по настроению</span>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Featured Collections -->
<section id="collections" class="section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Коллекции</h2>
            <p class="section-subtitle">Выберите букет для особого момента</p>
        </div>
        
        <div class="categories-grid">
            {% for category in categories|slice:":4" %}
            <a href="{% url 'shop:product_list_by_category' category.slug %}" class="category-card">
                <div class="category-image-wrapper">
                    {% if category.image %}
                    <img src="{{ category.image.url }}" alt="{{ category.name }}" class="category-image">
                    {% else %}
                    <div class="category-placeholder">
                        <i class="ri-flower-line"></i>
                    </div>
                    {% endif %}
                </div>
                <div class="category-content">
                    <h3 class="category-title">{{ category.name }}</h3>
                    <span class="category-count">{{ category.products.count }} букетов</span>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured Products -->
<section class="section bg-surface">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Популярные букеты</h2>
            <p class="section-subtitle">Выбор наших клиентов</p>
        </div>
        
        <div class="products-grid">
            {% for product in featured_products %}
            <div class="product-card">
                {% if product.available %}
                <span class="product-badge">В наличии</span>
                {% endif %}
                
                <div class="product-image">
                    {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}">
                    {% else %}
                    <div class="product-image-placeholder">
                        <i class="ri-image-line"></i>
                    </div>
                    {% endif %}
                    
                    <div class="product-overlay">
                        <div class="product-overlay-content">
                            <a href="{% url 'shop:product_detail' product.slug %}" class="btn btn-primary">
                                <i class="ri-eye-line"></i>
                                <span>Подробнее</span>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="product-content">
                    <div class="product-header">
                        <h3 class="product-title">{{ product.name }}</h3>
                        <span class="product-category">{{ product.category.name }}</span>
                    </div>
                    
                    <p class="product-description">{{ product.description|truncatechars:80 }}</p>
                    
                    <div class="product-footer">
                        <div class="product-price">{{ product.price }} ₽</div>
                        <div class="product-actions">
                            <form action="{% url 'shop:cart_add' product.id %}" method="post">
                                {% csrf_token %}
                                <input type="hidden" name="quantity" value="1">
                                <button type="submit" class="btn-icon" title="В корзину">
                                    <i class="ri-shopping-bag-line"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="empty-state">
                <i class="ri-flower-line"></i>
                <h3>Пока нет товаров</h3>
                <p>Скоро здесь появятся прекрасные букеты</p>
            </div>
            {% endfor %}
        </div>
        
        <div class="section-footer">
            <a href="{% url 'shop:product_list' %}" class="btn btn-outline">
                <span>Посмотреть все товары</span>
                <i class="ri-arrow-right-line"></i>
            </a>
        </div>
    </div>
</section>

<!-- Benefits -->
<section class="section">
    <div class="container">
        <div class="benefits-grid">
            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="ri-truck-line"></i>
                </div>
                <h3>Быстрая доставка</h3>
                <p>Доставляем в день заказа при оформлении до 16:00</p>
            </div>
            
            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="ri-secure-payment-line"></i>
                </div>
                <h3>Безопасная оплата</h3>
                <p>Оплачивайте картой, наличными или онлайн</p>
            </div>
            
            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="ri-gift-line"></i>
                </div>
                <h3>Подарочная упаковка</h3>
                <p>Бесплатная упаковка для всех букетов</p>
            </div>
            
            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="ri-customer-service-line"></i>
                </div>
                <h3>Поддержка 24/7</h3>
                <p>Наш флорист всегда на связи</p>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="section cta-section">
    <div class="container">
        <div class="cta-content">
            <h2 class="cta-title">Нужен особенный букет?</h2>
            <p class="cta-subtitle">Мы создадим индивидуальную композицию по вашему эскизу</p>
            <button class="btn btn-primary" data-modal="consultation">
                <i class="ri-chat-3-line"></i>
                <span>Заказать консультацию</span>
            </button>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Инициализация модального окна
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.id = 'consultation-modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h3>Консультация флориста</h3>
                <button class="modal-close"><i class="ri-close-line"></i></button>
            </div>
            <div class="modal-body">
                <p>Наш специалист свяжется с вами в течение 15 минут</p>
                <form class="consultation-form">
                    <div class="form-group">
                        <input type="text" placeholder="Ваше имя" required>
                    </div>
                    <div class="form-group">
                        <input type="tel" placeholder="Телефон" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span>Жду звонка</span>
                    </button>
                </form>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Открытие модального окна
    document.querySelector('[data-modal="consultation"]').addEventListener('click', () => {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    });
    
    // Закрытие модального окна
    modal.querySelector('.modal-close').addEventListener('click', () => {
        modal.classList.remove('active');
        document.body.style.overflow = '';
    });
    
    // Закрытие по клику вне модального окна
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }
    });
    
    // Отправка формы
    modal.querySelector('.consultation-form').addEventListener('submit', (e) => {
        e.preventDefault();
        showNotification('Мы скоро с вами свяжемся!', 'success');
        modal.classList.remove('active');
        document.body.style.overflow = '';
    });
});
</script>
{% endblock %}